# Анализ функциональности тасок и возможность переноса в Electron приложение

## Обзор функциональности

### Основные возможности системы тасок:

1. **Управление задачами (Tasks)**
   - Создание, редактирование, удаление задач
   - Привязка к заказам (order_id, order_type)
   - Назначение исполнителей (assignee_ids)
   - Категории задач
   - Статусы задач
   - Приоритеты
   - Дедлайны (finish_at)
   - Комментарии к задачам
   - Вложения файлов

2. **Доски (Boards) - Канбан**
   - Визуальное представление задач в виде колонок
   - Drag & Drop для перемещения задач между статусами
   - Настройка фона досок
   - Группировка задач по статусам

3. **Группировка и фильтрация**
   - Группировка по статусам
   - Группировка по дате выполнения (finish_at)
   - Группировка по исполнителям (assignee)
   - Группировка по доскам (board)
   - Фильтры по категориям, статусам, исполнителям
   - Поиск задач

4. **Автоматизация**
   - Автоматическое создание задач по расписанию
   - Регулярные задачи (recurring tasks)
   - Правила автоматизации с условиями
   - Cron-выражения для расписания

5. **Управление статусами и категориями**
   - Создание и редактирование статусов
   - Цветовая маркировка статусов
   - Создание и редактирование категорий
   - Настройка видимости категорий для ролей/пользователей
   - Настройка прав на создание задач в категориях

6. **Интеграция с заказами**
   - Поиск и привязка заказов к задачам
   - Отображение информации о заказе в задаче

## API Endpoints (из кода)

### Основные эндпоинты:
- `GET /boards/subdata` - получение справочных данных (статусы, пользователи, доски, категории)
- `GET /boards` - список досок
- `GET /boards/tasks/list` - список задач с группировкой
- `GET /boards/{board_id}/tasks/{task_id}` - получение задачи
- `POST /boards/{board_id}/tasks` - создание задачи
- `POST /boards/{board_id}/tasks/{task_id}` - обновление задачи
- `DELETE /boards/{board_id}/tasks/{task_id}` - удаление задачи
- `GET /boards/tasks/assigned-to-me` - задачи назначенные мне
- `POST /boards/{board_id}/tasks/{task_id}/complete-recurring` - завершение повторяющейся задачи
- `GET /boards/{board_id}/tasks/{task_id}/comments` - комментарии к задаче
- `POST /boards/{board_id}/tasks/{task_id}/comments` - создание комментария
- `DELETE /boards/{board_id}/tasks/{task_id}/comments/{comment_id}` - удаление комментария
- `GET /tasks/search-orders` - поиск заказов для привязки
- `GET /roles` - список ролей (для настроек категорий)

## Возможность переноса в Electron приложение

### ✅ ЧТО МОЖНО ПЕРЕНЕСТИ:

1. **Все основные функции управления задачами**
   - ✅ Создание, редактирование, удаление задач
   - ✅ Просмотр списка задач
   - ✅ Фильтрация и группировка
   - ✅ Назначение исполнителей
   - ✅ Управление статусами
   - ✅ Комментарии к задачам
   - ✅ Вложения файлов

2. **API интеграция**
   - ✅ Все API эндпоинты доступны через HTTP
   - ✅ Текущий ApiClient в chatapp уже поддерживает авторизацию через Bearer token
   - ✅ Можно использовать те же API endpoints

3. **UI компоненты**
   - ✅ React компоненты можно адаптировать из Vue компонентов
   - ✅ Стили можно перенести/адаптировать
   - ✅ Логика работы с данными аналогична

### ⚠️ ЧТО НУЖНО АДАПТИРОВАТЬ:

1. **Drag & Drop для Канбан досок**
   - Нужна библиотека для React (например, `react-beautiful-dnd` или `@dnd-kit/core`)
   - Адаптация компонентов BoardColumn, BoardCard

2. **Визуальные компоненты**
   - Замена Vuetify компонентов на React аналоги (Material-UI, Ant Design, или кастомные)
   - Адаптация стилей под темную тему приложения

3. **Автоматизация**
   - Логика автоматизации работает на бэкенде
   - В приложении нужен только UI для управления правилами
   - Cron-выражения и расписание обрабатываются на сервере

4. **Интеграция с заказами**
   - Поиск заказов через API (`/tasks/search-orders`)
   - Отображение информации о заказе в задаче

### ❌ ОГРАНИЧЕНИЯ/ОСОБЕННОСТИ:

1. **Права доступа**
   - Проверка прав (`checkAccess`) должна быть реализована через API
   - Некоторые функции могут быть недоступны в зависимости от роли пользователя

2. **WebSocket для real-time обновлений**
   - В chatapp уже есть WebSocket интеграция (Laravel Echo)
   - Можно использовать тот же механизм для обновлений задач в реальном времени

3. **Файловые вложения**
   - Загрузка файлов через API
   - Отображение превью файлов

## План реализации

### Этап 1: Базовая функциональность
1. Создать API методы для работы с задачами в `api/client.ts`
2. Создать компоненты:
   - `TasksList.tsx` - список задач
   - `TaskRow.tsx` - строка задачи
   - `TaskDialog.tsx` - модальное окно редактирования задачи
   - `TaskFilters.tsx` - фильтры задач

### Этап 2: Группировка и фильтрация
1. Реализовать группировку по статусам, датам, исполнителям
2. Добавить фильтры
3. Добавить поиск

### Этап 3: Канбан доски
1. Установить библиотеку для Drag & Drop
2. Создать компоненты BoardColumn, BoardCard
3. Реализовать перемещение задач между колонками

### Этап 4: Дополнительные функции
1. Комментарии к задачам
2. Вложения файлов
3. Интеграция с заказами
4. Управление статусами и категориями

### Этап 5: Автоматизация
1. UI для управления правилами автоматизации
2. Просмотр и редактирование правил

## Вывод

**✅ ВЫВОД: Все функции тасок МОЖНО перенести в Electron приложение**

Все API endpoints доступны через HTTP, логика работы с данными не зависит от платформы. Основная работа - это адаптация UI компонентов с Vue на React и интеграция с существующим API клиентом приложения.

**Оценка сложности:** Средняя
- Адаптация компонентов: 2-3 недели
- Интеграция с API: 1 неделя
- Тестирование и доработка: 1 неделя
- **Итого: ~4-5 недель разработки**

